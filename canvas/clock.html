<!DOCTYPE html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1.0,user-scalable=no"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#ffffff><title>时钟 | canvas-demo | Mirror Space</title><link href=/mirrorui/mirrorui.css rel=stylesheet><link href=/asset/css/blog.css rel=stylesheet><div class=layout><div class=layout-part1></div><div class=layout-part2><style>.clockbox{position:relative}.canva-panle{position:absolute;left:0;top:0}</style><h1>时钟</h1><p>运行的时钟,分两层canvas,底层是刻度,不动的.上层是时分秒,动的.<p>时刻度12份,每份30度.分刻度60份,每份6度,秒刻度60份,每份6度<h2>动画步骤</h2><p>对于秒针,每过一秒,走6度.<p>对于分针,每过一分,走6度.<p>对于时针,每过12分钟,走6度.<p>每帧会获取当前JS时间,取出时分秒,然后计算时钟针的所在位置<p>假如获取的时间是9点12分20秒.<h4>时针</h4><p>那么,时针位置是9*30度,(12点为起点),将画布旋转 9 * Math.Pi / 6.然后竖直画时针线.(0,0)(0,len)<p>时针的位置和分有关系,9点12分时,时针不能只是正对着9点,而需要体现过了12分这段位置<p>所以,旋转 9 * Math.Pi / 6的同时,还要加上 12 * Math.Pi / 6 / 12.小时刻度里的每一格相当于12<p>分钟,所以9点12分时,时针要处于9点,并且走过一格的位置.<h4>分针和秒针</h4><p>12分20秒,将画布旋转12 * Math.Pi / 30 和 20 * Math.PI / 30.然后竖直画分针秒针线.(0,0)(0,len)<p>分和秒的步进都是6度,秒针走60格是1分钟,此时分针走1格,分针走60格是一小时.<p>分针可以不必像时针那样体现秒针走了多少,例如半分钟时,分针要处在两格子中间.这个不必,当秒针走一圈时,让分针<p>跳一格就行.<div class=clockbox><canvas id=canvas1 class=canva-panle><h3>不支持canvas</h3></canvas><canvas id=canvas2 class=canva-panle><h3>不支持canvas</h3></canvas></div><script>function clockAni(){let f=document.querySelector("#canvas2");ctx=f.getContext("2d");ctx.canvas.width=400;ctx.canvas.height=400;ctx.clearRect(0,0,400,400);let i={x:200,y:200},n=160;ctx.translate(i.x,i.y);let r=(new Date).getSeconds(),t=(new Date).getMinutes(),u=(new Date).getHours();ctx.font="18px serial";ctx.fillText(`${u}:${t}:${r}`,-30,-50);ctx.save();ctx.rotate(u*Math.PI/6+t*Math.PI/360);ctx.beginPath();ctx.lineWidth=4;ctx.arc(0,90-n,5,0,Math.PI*2);ctx.moveTo(0,12);ctx.lineTo(0,95-n);ctx.stroke();ctx.restore();ctx.save();ctx.strokeStyle="orange";ctx.rotate(t*Math.PI/30);ctx.beginPath();ctx.lineWidth=3;ctx.arc(0,72-n,4,0,Math.PI*2);ctx.moveTo(0,14);ctx.lineTo(0,76-n);ctx.stroke();ctx.restore();ctx.save();ctx.strokeStyle="red";ctx.rotate(r*Math.PI/30);ctx.beginPath();ctx.lineWidth=1;ctx.arc(0,56-n,3,0,Math.PI*2);ctx.moveTo(0,16);ctx.lineTo(0,60-n);ctx.stroke();ctx.restore();window.requestAnimationFrame(clockAni)}function clockpanel(){var t;let r=document.querySelector("#canvas1");ctx=r.getContext("2d");ctx.canvas.width=400;ctx.canvas.height=400;let n={x:200,y:200},i=160;for(ctx.save(),ctx.beginPath(),ctx.lineWidth=4,ctx.strokeStyle="#325FA2",ctx.arc(n.x,n.y,i,0,Math.PI*2),ctx.stroke(),ctx.beginPath(),ctx.lineWidth=1,ctx.strokeStyle="gray",ctx.arc(n.x,n.y,i*.74,0,Math.PI*2),ctx.stroke(),ctx.beginPath(),ctx.lineWidth=1,ctx.arc(n.x,n.y,i/8,0,Math.PI*2),ctx.stroke(),ctx.beginPath(),ctx.arc(n.x,n.y,5,0,Math.PI*2),ctx.fill(),ctx.restore(),ctx.save(),ctx.translate(n.x,n.y),t=0;t<12;t++)ctx.beginPath(),ctx.moveTo(i-15,0),ctx.lineTo(i,0),ctx.stroke(),ctx.rotate(Math.PI/6);for(ctx.restore(),ctx.save(),ctx.translate(n.x,n.y),t=0;t<60;t++)t%5!=0&&(ctx.beginPath(),ctx.moveTo(i-8,0),ctx.lineTo(i,0),ctx.stroke()),ctx.rotate(Math.PI/30);for(ctx.restore(),ctx.save(),ctx.font="18px arial",ctx.textAlign="center",ctx.translate(n.x,n.y),t=12;t>0;t--)ctx.beginPath(),ctx.fillText(t,0,35-i),ctx.rotate(-Math.PI/6);ctx.restore()}clockpanel();window.requestAnimationFrame(clockAni)</script></div></div><script src=/asset/js/mainmenu.js></script>