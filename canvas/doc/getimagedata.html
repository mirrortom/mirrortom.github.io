<div class=doc-page><h2>getImageData()</h2><p>用来描述canvas区域隐含的像素数据,这个区域通过矩形表示,起始点为(sx, sy)、宽为sw、高为sh<pre>
  ctx.getImageData(sx, sy, sw, sh);
</pre><h4>参数</h4><p><b class=txt-sky-4>sx</b> <small>Number</small> 将要被提取的图像数据矩形区域的左上角 x 坐标.<p><b class=txt-sky-4>sy</b> <small>Number</small> 将要被提取的图像数据矩形区域的左上角 y 坐标.<p><b class=txt-sky-4>sw</b> <small>Number</small> 将要被提取的图像数据矩形区域的宽度.<p><b class=txt-sky-4>sh</b> <small>Number</small> 将要被提取的图像数据矩形区域的高度.</p><br><h4>测验</h4><p>getImageData(10, 10, 100, 50) 返回一个ImageData对象,可用于<a class=goto onclick='mainmenugoto("putImageData")'>putImageData</a>的参数<p>简单的讲,就是取画布中的一块矩形区域的内容.下左图是原图,右图是其中间部分.<div class=grids><canvas id=canvas1></canvas><canvas id=canvas2></canvas></div><h3>ImageData对象</h3><p>有三个属性: "width"宽度 ,"height":高度,这两个值并不总是等于getImageData()方法传入的宽高参数.因为这参数是设备像素单位,而这两属性是css像素单位.<p>"data"是一个Uint8ClampedArray类型,长度等于4*width*height的数组,其中每一位元素都是一个0~255之间的数,其实它是一个8位的二进制值,是表示像素<p>颜色的,由公式可知,每4个元素表示一个像素颜色.即(R,G,B,A)表示法,也就是红绿蓝原色加透明度.注意透明度的取值范围也是(0~255)<p>那么,如果修改这个数组,那么图像就会有变化.下图将取出的部分图像,将每个像素的RGB值替换为其(R+G+B)/3,可见,变黑白的了<p>下图左边是自己随机填充的ImageData对象.看起来就像电视机的雪花点</p><canvas id=canvas3></canvas></div><script>function test3(){var n;let u=cavlib("canvas1").style(),f=u.ctx,t=f.getImageData(75,37,150,75);for(n=0;n<t.data.length-4;n+=4){let i=(t.data[n]+t.data[n+1]+t.data[n+2])/3;t.data[n]=t.data[n+1]=t.data[n+2]=i}let e=cavlib("canvas3").style(),r=e.ctx;r.putImageData(t,10,10);let i=new Uint8ClampedArray(4e4);for(n=0;n<i.length;n+=4)i[n]=i[n+1]=i[n+2]=randInt(0,256),i[n+3]=256;let o=new ImageData(i,100,100);r.putImageData(o,180,10)}function test2(){let n=cavlib("canvas1").style(),t=cavlib("canvas2").style(),i=n.ctx,r=t.ctx,u=i.getImageData(75,37,150,75);r.putImageData(u,10,10)}function test1(){let t=cavlib("canvas1").style(),n=t.ctx;n.fillStyle="#ff1257";n.fillRect(0,0,150,75);n.fillStyle="#33ff11";n.fillRect(150,0,300,75);n.fillStyle="#1234ff";n.fillRect(0,75,150,150);n.fillStyle="#808080";n.fillRect(150,75,300,150);n.font="18px serial";n.strokeStyle="white";n.rect(75,37,150,75);n.setLineDash([5,10]);n.stroke()}function randInt(n,t){let i=Math.random()*(t-n);return Math.floor(i)+n}test1();test2();test3()</script>