<!DOCTYPE html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1.0"><link href=/asset/css/createform.css rel=stylesheet><style>.container{grid-template-rows:repeat(2,calc(50vh - 15px));grid-template-columns:max(10%,100px) 50% auto}.toolsbox,.propbox{background-color:#fff;overflow-x:hidden;overflow-y:auto}.toolsbox,.viewbox{grid-row:span 2}.tool-item{display:flex;justify-content:space-between;padding:8px;cursor:pointer;user-select:none}.tool-item:active{color:#f00}.form-box{max-height:calc(100vh - 100px);overflow-y:auto}.form-group{min-height:30px}.form-area{min-height:20px}.form-group:empty{background-color:#efefef}.form-area:empty{background-color:#ffd800}.selected{outline:3px dotted #f00}.btnflag{color:#f00}</style><div class="container grid pd-10 gap-row-5 gap-col-10 bg-gray-2"><div class=toolsbox id=toolsBox><div class=tool-item id=text><span>input(Text)</span> <span>></span></div><div class=tool-item id=pwd><span>input(Password)</span> <span>></span></div><div class=tool-item id=tel><span>input(Tel)</span> <span>></span></div><div class=tool-item id=email><span>input(Email)</span> <span>></span></div><div class=tool-item id=textarea><span>Textarea</span> <span>></span></div><div class=tool-item id=select><span>Select</span> <span>></span></div><div class=tool-item id=check><span>input(Check)</span> <span>></span></div><div class=tool-item id=radio><span>input(Radio)</span> <span>></span></div><div class=tool-item id=file><span>input(File)</span> <span>></span></div><div class=tool-item id=label><span>Label.form-label</span> <span>></span></div><div class=tool-item id=divArea><span>Div.form-area</span> <span>></span></div><div class=tool-item id=div><span>Div.form-group</span> <span>></span></div></div><div class="viewbox bg-gray-1"><div class=txt-center><span class="btn-group txt-md"><m-btn id=screenChgBtn val=1>📱</m-btn><m-btn id=layoutBtn val=0>单行S</m-btn><m-btn id=sizeBtn val=0>S1</m-btn><m-btn id=delBtn>× 🗑</m-btn></span></div><div class=mg-b-15><span class="btn-group txt-md" id=formGroupCtrlBox></span></div><div class="form-box pd-15 bg-white-0 grid grid-row gap-row-10 w-420 mg-lr-auto" id=formBox></div></div><div class="propbox txt-sm pd-5" id=propBox></div><div class=codebox><div class="flex a-center j-between"><label id=infoLbl></label> <span class="btn-group txt-md"><m-btn id=selAllBtn val=1>全选All</m-btn><m-btn id=copyBtn>复制Copy</m-btn></span></div><textarea class="textarea bg-black-1 txt-white-1 min-h-86p" id=codeBox readonly></textarea></div></div><template id=textTpl><div class="form-group grid grid-20p a-center"><label class=form-label>标题1</label><div class=p-rel><input class="input-text sky" name="" type=text value="" placeholder=文本框1> <span class="clear-btn abs-tb-center right-10">╳</span></div></div></template><template id=pwdTpl><div class="form-group grid grid-20p a-center"><label class=form-label>密码1</label><div class=p-rel><input class="input-text sky" name="" type=password value="" placeholder=密码框1> <span class="clear-btn abs-tb-center right-10">╳</span></div></div></template><template id=telTpl><div class="form-group grid grid-20p a-center"><label class=form-label>手机号1</label><div class=p-rel><input class="input-text sky" name="" type=tel value="" vtype=mobile verrmsg=手机号无效. placeholder=手机号码1 maxlength=11> <span class="clear-btn abs-tb-center right-10">╳</span></div></div></template><template id=emailTpl><div class="form-group grid grid-20p a-center"><label class=form-label>电子邮箱1</label><div class=p-rel><input class="input-text sky" name="" type=email value="" vtype=email verrmsg=邮件地址无效. placeholder=电子邮箱1> <span class="clear-btn abs-tb-center right-10">╳</span></div></div></template><template id=checkTpl><m-check class=sky tag=多选框1></m-check></template><template id=radioTpl><m-radio class=sky tag=单选框1></m-radio></template><template id=textareaTpl><div class="form-group grid grid-20p a-center"><label class=form-label>多行文本1</label><textarea class="textarea sky"></textarea></div></template><template id=selectTpl><div class="form-group grid grid-20p a-center"><label class=form-label>选项1</label><select class="select sky"><option>请选择...<option>选项1<option>选项2<option>选项3</select></div></template><template id=fileTpl><m-file class=sky tag=文件上传 multiple></m-file></template><template id=labelTpl><label class=form-label>标题1</label></template><template id=divTpl><div class="form-group grid grid-20p a-center"></div></template><template id=divAreaTpl><div class="form-area flex j-between a-center"></div></template><template id=inputPropTpl><div class="grid grid-20p a-center mg-b-5"><label>type</label><span>${type}</span></div><div class="grid grid-20p a-center mg-b-5"><label>name</label><input class=input-text is=m-inputwatch pname=name type=text value=${name} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>id</label><input class=input-text is=m-inputwatch pname=id type=text value=${id} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Title</label><input class=input-text is=m-inputwatch pname=title type=text value=${title} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Style</label> <span>${style}</span></div><div class="grid grid-20p a-center mg-b-5"><label>Placeholder</label><input class=input-text is=m-inputwatch pname=placeholder type=text value=${placeholder} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Vtype</label><input class=input-text is=m-inputwatch pname=vtype type=text value=${vtype} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Vmsg</label><input class=input-text is=m-inputwatch pname=verrmsg type=text value=${vmsg} maxlength=100></div><div class="grid grid-20p a-center mg-b-5"><label>Maxlen</label><input class=input-text is=m-inputwatch pname=maxlength type=number value=${maxlen} maxlength=10></div><div class="grid grid-20p a-center mg-b-5"><label>Minlen</label><input class=input-text is=m-inputwatch pname=minlength type=number value=${minlen} maxlength=10></div></template><template id=textareaPropTpl><div class="grid grid-20p a-center mg-b-5"><label>type</label><span>${type}</span></div><div class="grid grid-20p a-center mg-b-5"><label>name</label><input class=input-text is=m-inputwatch pname=name type=text value=${name} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>id</label><input class=input-text is=m-inputwatch pname=id type=text value=${id} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Title</label><input class=input-text is=m-inputwatch pname=title type=text value=${title} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Style</label> <span>${style}</span></div><div class="grid grid-20p a-center mg-b-5"><label>Vtype</label><input class=input-text is=m-inputwatch pname=vtype type=text value=${vtype} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Vmsg</label><input class=input-text is=m-inputwatch pname=verrmsg type=text value=${vmsg} maxlength=100></div><div class="grid grid-20p a-center mg-b-5"><label>Maxlen</label><input class=input-text is=m-inputwatch pname=maxlength type=number value=${maxlen} maxlength=10></div><div class="grid grid-20p a-center mg-b-5"><label>Minlen</label><input class=input-text is=m-inputwatch pname=minlength type=number value=${minlen} maxlength=10></div></template><template id=selectPropTpl><div class="grid grid-20p a-center mg-b-5"><label>type</label><span>${type}</span></div><div class="grid grid-20p a-center mg-b-5"><label>name</label><input class=input-text is=m-inputwatch pname=name type=text value=${name} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>id</label><input class=input-text is=m-inputwatch pname=id type=text value=${id} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Title</label><input class=input-text is=m-inputwatch pname=title type=text value=${title} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Style</label> <span>${style}</span></div><div class="grid grid-20p a-center mg-b-5"><label>Vtype</label><input class=input-text is=m-inputwatch pname=vtype type=text value=${vtype} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Vmsg</label><input class=input-text is=m-inputwatch pname=verrmsg type=text value=${vmsg} maxlength=100></div></template><template id=checkPropTpl><div class="grid grid-20p a-center mg-b-5"><label>type</label><span>${type}</span></div><div class="grid grid-20p a-center mg-b-5"><label>name</label><input class=input-text is=m-inputwatch pname=name type=text value=${name} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>id</label><input class=input-text is=m-inputwatch pname=id type=text value=${id} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Tag</label><input class=input-text is=m-inputwatch pname=tag type=text value=${tag} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Style</label> <span>${style}</span></div></template><template id=filePropTpl><div class="grid grid-20p a-center mg-b-5"><label>type</label><span>${type}</span></div><div class="grid grid-20p a-center mg-b-5"><label>id</label><input class=input-text is=m-inputwatch pname=id type=text value=${id} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Tag</label><input class=input-text is=m-inputwatch pname=tag type=text value=${tag} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Style</label> <span>${style}</span></div><div class="grid grid-20p a-center mg-b-5"><label></label><div><m-check class=${multiple} pname=multiple tag=multiple></m-check></div></div></template><template id=labelPropTpl><div class="grid grid-20p a-center mg-b-5"><label>type</label><span>${type}</span></div><div class="grid grid-20p a-center mg-b-5"><label>name</label><input class=input-text is=m-inputwatch pname=name type=text value=${name} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>id</label><input class=input-text is=m-inputwatch pname=id type=text value=${id} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Ttile</label><input class=input-text is=m-inputwatch pname=title type=text value=${title} maxlength=50></div><div class="grid grid-20p a-center mg-b-5"><label>Style</label> <span>${style}</span></div></template><script src=/jslib/jslib.js></script><script src=/mirrorui/mirrorui.js></script><script>function formObjects(){return{text:{type:"text",suit:!0,propId:"input"},pwd:{type:"pwd",suit:!0,propId:"input"},tel:{type:"tel",suit:!0,propId:"input"},email:{type:"email",suit:!0,propId:"input"},textarea:{type:"textarea",suit:!0,propId:"textarea"},select:{type:"select",suit:!0,propId:"select"},check:{type:"check",suit:!1,propId:"check"},radio:{type:"radio",suit:!1,propId:"check"},file:{type:"file",suit:!1,propId:"file"},label:{type:"label",suit:!1,propId:"label"},divArea:{type:"area",level:2},div:{type:"group",level:1}}}function init(){$("#toolsBox .tool-item").click(n=>{toolsBtnHandler(n)});$("#screenChgBtn").click(n=>{screenSizeBtnHandler(n)});$("#delBtn").click(()=>{delBtnHandler()});$("#layoutBtn").click(n=>{layoutBtnHandler(n)});$("#sizeBtn").click(n=>{sizeBtnHandler(n)});$("#selAllBtn").click(n=>{selAllBtnHandler(n)});$("#copyBtn").click(n=>{copyBtnHandler(n)})}function toolsBtnHandler(n){let u=$(n).prop("id"),i=context[u],e=u+"Tpl",o=$("#"+e).html(),t=$.fragment();if($(t).append(o),i.level>=0&&$(t).first().prop("level",i.level),$(t).first().prop("formType",i.type),$(t).first().addEvent("click",formSelectHandler),i.level==1||i.suit==!0){$("#formBox .selected").removeClass("selected");$(t).first().addClass("selected");$("#formBox").append(t);updateStatus();return}let r=$("#formBox .form-group.selected,.form-area.selected");if(r.length==1){let f=r.prop("level");f!=null&&(i.level!=2||f!=2)&&(i.level==2&&($("#formBox .selected").removeClass("selected"),$(t).first().addClass("selected")),r.append(t),updateStatus())}}function screenSizeBtnHandler(n){let t=$(n).prop("val");t==1?($("#formBox").removeClass("w-420"),$(n).html("💻").prop("val",0)):t==0&&($("#formBox").addClass("w-420"),$(n).html("📱").prop("val",1))}function delBtnHandler(){$("#formBox .selected").remove();updateStatus()}function layoutBtnHandler(n){let t="",i=$("#formBox .form-group.selected");t=i.length>0?i:$("#formBox .form-group");let r=$(n).prop("val");r==0?(t.removeClass("grid","grid-20p","a-center"),$(n).html("多行M").prop("val",1)):r==1&&(t.addClass("grid","grid-20p","a-center"),$(n).html("单行S").prop("val",0))}function sizeBtnHandler(n){let t=$(n).prop("val");t==0?($("#formBox").addClass("txt-sm"),$(n).html("S0").prop("val",1)):t==1&&($("#formBox").removeClass("txt-sm"),$(n).html("S1").prop("val",0))}function selAllBtnHandler(){$("#codeBox")[0].select()}function copyBtnHandler(){let n=$("#codeBox").val();n.length!=0&&navigator.clipboard.writeText(n).then(()=>{$("#codeBox")[0].select(),$("#infoLbl").text("copied!"),setTimeout(()=>{$("#infoLbl").empty()},1e3)},()=>{$("#infoLbl").text("copy err!")})}function formSelectHandler(n){n.preventDefault();n.stopPropagation();let t=n.currentTarget,i="selected";$(t).hasClass(i)?$(t).removeClass(i):($(t).parent(".form-area").removeClass(i),$(t).parent(".form-group").removeClass(i),$(t).find("."+i).removeClass(i),$(t).addClass(i));let r;r=$(t).hasClass("form-group")?$(t).index():$(t).parent(".form-group").index();let u=$("#formGroupCtrlBox m-btn").eq(r);$(t).hasClass(i)||$(t).find("."+i).length>0?u.addClass(i):u.removeClass(i);updatePropSetBox()}function updateStatus(){updateformGroupCtrlBox();updateCodeBox();updatePropSetBox()}function updateformGroupCtrlBox(){let n="selected",t="";$("#formBox .form-group").each((i,r)=>{t+="<m-btn",($(i).hasClass(n)||$(i).find("."+n).length>0)&&(t+=` class="${n}"`),t+=`>${r}</m-btn>`});$("#formGroupCtrlBox").html(t);$("#formGroupCtrlBox m-btn").click(t=>{let r=$(t).index(),i=$("#formBox .form-group").eq(r);$(t).hasClass(n)?(i.removeClass(n).find("."+n).removeClass(n),$(t).removeClass(n)):(i.addClass(n).find("."+n).removeClass(n),$(t).addClass(n));updatePropSetBox()})}function updateCodeBox(){let i=$("#formBox").html(),t=$.fragment();$(t).append(i);$(t).find(".selected").removeClass("selected");$(t).find("[level],[formType]").removeProp("level","formType");let n="";$(t).find(".form-group").each(t=>{n+=t.outerHTML,n+="\n\n"});n=n.substr(0,n.length-2);$("#codeBox").val(n)}function updatePropSetBox(){let t=$("#formBox .selected");if(t.length!=1){$("#propBox").empty();return}let i=t.prop("formType");if(i=="area"||i=="group"){$("#propBox").empty();return}let n=context[i];if(!n.propId){$("#propBox").empty();return}let r=n.propId+"PropTpl",u=$("#"+r).html(),f=getDataByPropId(n.propId,t[0]),e=$.dataBind(u,f);$("#propBox").html(e).prop("currPropType",n.propId);propSetBoxEvents()}function getDataByPropId(n,t){switch(n){case"input":return getPropsFormInput(t);case"textarea":return getPropsFormTextarea(t);case"select":return getPropsFormSelect(t);case"check":return getPropsFormCheck(t);case"file":return getPropsFormFile(t);case"label":return getPropsFormLabel(t);default:return{}}}function getPropsFormInput(n){let t={},i=$(n).find("input").eq(0);return t.type="input-"+$(n).find("input").prop("type"),t.title=$(n).find("label").html(),t.name=i.prop("name")||"",t.id=i.prop("id")||"",t.style=i.prop("class")||"",t.placeholder=i.prop("placeholder")||"",t.vtype=i.prop("vtype")||"",t.vmsg=i.prop("verrmsg")||"",t.maxlen=i.prop("maxlength")||"",t.minlen=i.prop("minlength")||"",t}function getPropsFormTextarea(n){let t={},i=$(n).find("textarea").eq(0);return t.type="textarea",t.title=$(n).find("label").html(),t.name=i.prop("name")||"",t.id=i.prop("id")||"",t.style=i.prop("class")||"",t.vtype=i.prop("vtype")||"",t.vmsg=i.prop("verrmsg")||"",t.maxlen=i.prop("maxlength")||"",t.minlen=i.prop("minlength")||"",t}function getPropsFormSelect(n){let t={},i=$(n).find("select").eq(0);return t.type="select",t.title=$(n).find("label").html(),t.name=i.prop("name")||"",t.id=i.prop("id")||"",t.style=i.prop("class")||"",t.vtype=i.prop("vtype")||"",t.vmsg=i.prop("verrmsg")||"",t}function getPropsFormCheck(n){let t={},i=$(n);return t.type=i.prop("formtype"),t.tag=n.tag,t.name=i.prop("name")||"",t.id=i.prop("id")||"",t.style=i.prop("class")||"",t.style=$.trim(t.style.replace("selected","")),t}function getPropsFormFile(n){let t={},i=$(n);return t.type=i.prop("formtype"),t.tag=n.tag,t.id=i.prop("id")||"",t.style=i.prop("class")||"",t.style=$.trim(t.style.replace("selected","")),t.multiple=n.multiple?"checked":"",t}function getPropsFormLabel(n){let t={},i=$(n);return t.type=i.prop("formtype"),t.title=$(n).html(),t.name=i.prop("name")||"",t.id=i.prop("id")||"",t.style=i.prop("class")||"",t.style=$.trim(t.style.replace("selected","")),t}function propSetBoxEvents(){let n=(n,t)=>{let f=$("#formBox .selected");if(f.length==1){let i=$(t).prop("pname"),u=$("#propBox").prop("currPropType"),r=f[0];u=="input"||u=="textarea"||u=="select"?i=="title"?$(r).find(".form-label").html(n):$(r).find("input,textarea,select").eq(0).prop(i,n):u=="check"?i=="tag"?r.tag=n:$(r).prop(i,n):u=="file"?i=="tag"?r.tag=n:$(r).prop(i,n):u=="label"&&(i=="title"?$(r).html(n):$(r).prop(i,n));updateCodeBox()}},t=n=>{let t=$("#formBox .selected");if(t.length==1){let r=$(n).prop("pname"),u=$("#propBox").prop("currPropType"),i=t[0];if(u=="file"&&r=="multiple"){let t=i.multiple;i.multiple=n.checked}updateCodeBox()}};$("#propBox").find("input[is=m-inputwatch]").each(t=>{t.onChange=n});$("#propBox").find("m-check").each(n=>{n.onClicked=t})}function createForm(n=null){$("#errinfobox").html("");let t=validPara();if(t!=!1){let u=formTempHtml(t.ftype);u=$.dataBind(u,t);let i=$("<div>").html(u)[0];if(["check","radio"].indexOf(t.ftype)>=0?$(i).find("m-radio,m-check").html(""):(t.vtype&&$(i).find("input,textarea,select").prop({vtype:t.vtype,verrmsg:t.verrmsg}),t.minlength>0&&$(i).find("input,textarea,select").prop("minlength",t.minlength),t.maxlength>0&&$(i).find("input,textarea,select").prop("maxlength",t.maxlength),isNaN(t.minnum)||$(i).find("input,textarea,select").prop("minnum",t.minnum),isNaN(t.maxnum)||$(i).find("input,textarea,select").prop("maxnum",t.maxnum)),n==="grid"){let t=$("#flabel_grid").val(),u=$("#finput_grid").val();if(parseInt(t)+parseInt(u)!=12){$("#errinfobox").html("! [栅格比例] 栅格总和必须是12");return}$(i).find(".form-label,m-check,m-radio").addClass("grid-"+t);$(i).find(".input-text,.textarea,.select").addClass("grid-"+u);let e='<div class="grid f-v-center">\n'+i.innerHTML+"\n<\/div>",n=e.split("\n");for(var r=1,f=n.length-1;r<f;r++)n[r]="    "+n[r];$("#htmlbox").val(n.join("\n"))[0].select();return}$("#htmlbox").val(i.innerHTML)[0].select()}}function formTempHtml(n){return{text:'<label class="form-label">${flabel}<\/label>\n<input class="input-text" name="${fname}" type="text" value="" placeholder="${fplaceholder}" />',pwd:'<label class="form-label">${flabel}<\/label>\n<input class="input-text" name="${fname}" type="password" value="" placeholder="${fplaceholder}" />',select:'<label class="form-label">${flabel}<\/label>\n<select class="select" name="${fname}" >\n    <option value="">请选择...<\/option>\n    <option value="1">选项1<\/option>\n    <option value="2">选项2<\/option>\n<\/select>',textarea:'<label class="textarea-label">${flabel}<\/label>\n<textarea class="textarea" name="${fname}" placeholder="${fplaceholder}" ><\/textarea>',radio:'<m-radio name="${fname}" tag="${flabel}"><\/m-radio>',check:'<m-check name="${fname}" tag="${flabel}"><\/m-check>'}[n]}function validPara(){let n={},o=$("m-radio[name=formtype].checked");if(o.length!=1)return $("#errinfobox").html("! [表单类型] 选择一个表单类型"),!1;n.ftype=o[0].id.replace("ftype_","");$("#para_1").find("input[name]").each(t=>{n[t.name]=t.value});let t=[],i=[];$("#para_2,#para_3").find("m-check.checked").each(n=>{t.push(n.id.replace("vtype_","")),i.push(n.getAttribute("errmsg"))});let r=parseInt($("#vtype_minlen").val()),u=parseInt($("#vtype_maxlen").val());if(r>0&&u>0&&u<r)return console.log(u+"____"+r),$("#errinfobox").html("! [长度验证] 最小长度不能大于最大长度"),!1;r>0&&(t.push("minlen"),i.push(`至少${r} 个字符`));u>0&&(t.push("maxlen"),i.push(`不超过${u} 个字符`));n.maxlength=u;n.minlength=r;let f=parseFloat($("#vtype_minnum").val()),e=parseFloat($("#vtype_maxnum").val());return e<f?($("#errinfobox").html("! [范围验证] 最小值不能大于最大值"),!1):(e>f&&(isNaN(f)||(t.push("minnum"),i.push(`不小于${f} `)),isNaN(e)||(t.push("maxlen"),i.push(`不大于${e} `)),n.minnum=f,n.maxnum=e),n.vtype=t.join("|"),n.verrmsg=i.join("|"),n)}function reset(){$("#htmlbox").val("");$("#formcreatebox").find(".input-check").each(n=>{$(n).removeClass("checked")});$("#formcreatebox input[type=text]").val("");$("#vtype_minlen").val(0);$("#vtype_maxlen").val(0)}let context=formObjects();init()</script>