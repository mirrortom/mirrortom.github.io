<!DOCTYPE html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1.0"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#ffffff><title>贝塞尔曲线 | Mirror Space</title><link href=/asset/css/blogArticle.css rel=stylesheet><div class=layout><div class=layout-part1></div><div class="layout-part2 layout-article"><div class=wz-page><div class=txt-center><h1>贝塞尔曲线</h1><span class=txt-gray-5>作者: </span><span>mirror</span> <span class="mg-l-10 txt-gray-5">日期: </span><span>2019/8/31</span></div><hr class="bd-none bd-t-1 bd-t-gray-4 mg-t-10"><div id=page_content><p>参考了一些资料,贝塞尔曲线的逻辑大概如下<h3>约束条件</h3><p>平面上选三个点,三点不共线.设起点为S,终点为E,控制点为C<p>SC上取一点A,CE上取一点B,A和B取点时满足 SA/SC==CB/CE<p>连接AB,取一点a1,取点满足 Aa1/AB==SA/SC==CB/CE<p>a1点就是二次贝塞尔曲线上的一点,使用上述规则找出满足条件的所有点,得到二次贝塞尔曲线<div class=grids><canvas id=canvas1></canvas><canvas id=canvas2></canvas></div><h3>一次曲线和多次曲线</h3><p>二次贝塞尔曲线有一个起点一个终点和一个控制点,三次贝塞尔曲线有两个控制点,N次曲线有N-1个控制点(想当然的)<p>规则和二次的一样,例如有个4次曲线,那就有3个控制点,加上起止点一共5个.<p>设起点S,控制点为(C1,C2,C3),终点E.按照规则,取SC1,C1C2,C2C3,C3E这四条线段上各一点A,B,C,D(下图蓝色点),满足<p>SA / SC1 == C1B / C1C2 == C2C / C2C3 == C3D / C3E<p>连接A,B,C,D得到三条线段,再一次按规则取,AB,BC,CD这三条线段上各一点F,G,H(下图绿色),满足<p>AF / AB == BG / BC == CH / CD<p>连接F,G,H得到二条线段,这时,就是一个有3个点的二次曲线情况.最后得到曲线点(下图红色)<p>N次曲线,最终都会收窄成二次曲线的情况,然后得到最终曲线<div class=grids><canvas id=canvas3></canvas><canvas id=canvas4></canvas></div><p>如果二次曲线的控制点在起点和终点的连线上会如何.结果曲线成了一条直线.那么一次贝塞尔曲线是直线<p>那么这也能说明,直线是曲线的特例,2点间最短的距离是直线</p><canvas id=canvas5></canvas><script src=/cavlib/cavlib.js></script><script>function test5(){var t;let e=cavlib("canvas5").style(),n=e.ctx;n.lineWidth=2;n.font="16px serial";let r={x:20,y:70},u={x:120,y:70},f={x:260,y:70};n.moveTo(r.x,r.y);n.lineTo(u.x,u.y);n.lineTo(f.x,f.y);n.stroke();n.fillText("S",r.x,r.y+15);n.fillText("C",u.x,u.y+15);n.fillText("E",f.x,f.y+15);let i=[];for(t=0;t<3;t++){let n=getBezier2Point(r,u,f,28*(t+1));if(n==null)break;i.push(n)}for(t=0;t<i.length;t++)n.beginPath(),n.fillStyle="black",n.fillText("A"+(t+1),i[t][0].x-25,i[t][0].y-5),n.arc(i[t][0].x,i[t][0].y,4,0,Math.PI*2),n.fill(),n.beginPath(),n.fillText("B"+(t+1),i[t][1].x+5,i[t][1].y-5),n.arc(i[t][1].x,i[t][1].y,4,0,Math.PI*2),n.fill(),n.beginPath(),n.fillStyle="red",n.fillText("a"+(t+1),i[t][2].x-10,i[t][2].y+20),n.arc(i[t][2].x,i[t][2].y,4,0,Math.PI*2),n.fill(),n.beginPath(),n.moveTo(i[t][0].x,i[t][0].y),n.lineTo(i[t][1].x,i[t][1].y),n.strokeStyle="green",n.stroke();for(n.beginPath(),n.strokeStyle="red",n.moveTo(i[0][2].x,i[0][2].y),t=1;t<i.length;t++)n.lineTo(i[t][2].x,i[t][2].y);n.stroke()}function test4(){let e=cavlib("canvas4").style(),n=e.ctx,i=[{x:20,y:20},{x:40,y:120},{x:120,y:130},{x:220,y:10},{x:260,y:130}],t=[],f=1;for(;;){let n=getBezierNPoint(i,f);if(n==null)break;t.push(n);f++}let r=0,o=t.length,u=()=>{var f;for(n.clearRect(0,0,300,150),n.beginPath(),n.moveTo(i[0].x,i[0].y),f=1;f<i.length;f++)n.lineTo(i[f].x,i[f].y);n.strokeStyle="black";n.stroke();n.fillStyle="green";let e=t[r];for(f=0;f<e.length-1;f++)n.beginPath(),n.arc(e[f].x,e[f].y,4,0,Math.PI*2),n.fill();n.fillStyle="red";n.beginPath();let s=e[e.length-1];for(n.arc(s.x,s.y,4,0,Math.PI*2),n.fill(),n.beginPath(),n.moveTo(e[0].x,e[0].y),f=1;f<e.length-1;f++)n.lineTo(e[f].x,e[f].y);n.strokeStyle="green";n.stroke();n.beginPath();n.strokeStyle="red";let h=t[0][t[0].length-1];for(n.moveTo(h.x,h.y),f=1;f<r;f++){let i=t[f][t[f].length-1];n.lineTo(i.x,i.y)}if(n.stroke(),r++,r===o){r=0;window.setTimeout(()=>{window.requestAnimationFrame(u)},1e3);return}window.requestAnimationFrame(u)};window.requestAnimationFrame(u)}function test3(){var i;let u=cavlib("canvas3").style(),n=u.ctx;n.lineWidth=2;n.font="16px serial";let r=[{x:20,y:20},{x:40,y:120},{x:120,y:130},{x:220,y:10},{x:260,y:130}];for(n.beginPath(),n.moveTo(r[0].x,r[0].y),i=1;i<r.length;i++)n.lineTo(r[i].x,r[i].y);n.stroke();n.fillText("S",5,15);n.fillText("C1",10,130);n.fillText("C2",120,145);n.fillText("C3",200,120);n.fillText("E",270,20);let t=getBezierNPoint(r,35);for(n.fillStyle=n.strokeStyle="blue",n.fillText("A",t[0].x+5,t[0].y),n.fillText("B",t[1].x,t[1].y+20),n.fillText("C",t[2].x,t[2].y+20),n.fillText("D",t[3].x+10,t[3].y+5),i=0;i<4;i++)n.beginPath(),n.arc(t[i].x,t[i].y,4,0,Math.PI*2),n.fill();for(n.beginPath(),n.moveTo(t[0].x,t[0].y),i=1;i<4;i++)n.lineTo(t[i].x,t[i].y);for(n.stroke(),n.fillStyle=n.strokeStyle="green",n.fillText("F",t[4].x+5,t[4].y),n.fillText("G",t[5].x-5,t[5].y+25),n.fillText("H",t[6].x-5,t[6].y-10),i=4;i<7;i++)n.beginPath(),n.arc(t[i].x,t[i].y,4,0,Math.PI*2),n.fill();for(n.beginPath(),n.moveTo(t[4].x,t[4].y),i=5;i<7;i++)n.lineTo(t[i].x,t[i].y);for(n.stroke(),n.fillStyle=n.strokeStyle="red",i=7;i<9;i++)n.beginPath(),n.arc(t[i].x,t[i].y,4,0,Math.PI*2),n.fill();n.fillText("I",t[7].x,t[7].y-10);n.fillText("J",t[8].x-5,t[8].y-10);n.beginPath();n.moveTo(t[7].x,t[7].y);n.lineTo(t[8].x,t[8].y);n.stroke();n.beginPath();n.fillStyle="black";n.arc(t[9].x,t[9].y,4,0,Math.PI*2);n.fill()}function test2(){let s=cavlib("canvas2").style(),n=s.ctx,r={x:20,y:120},u={x:80,y:30},f={x:250,y:130},t=[],o=1;for(;;){let n=getBezier2Point(r,u,f,o);if(n==null)break;t.push(n);o++}let i=0,h=t.length,e=()=>{n.clearRect(0,0,300,150);n.moveTo(r.x,r.y);n.lineTo(u.x,u.y);n.lineTo(f.x,f.y);n.strokeStyle="black";n.stroke();n.beginPath();n.fillStyle="red";n.arc(t[i][0].x,t[i][0].y,4,0,Math.PI*2);n.fill();n.beginPath();n.arc(t[i][1].x,t[i][1].y,4,0,Math.PI*2);n.fill();n.beginPath();n.fillStyle="blue";n.arc(t[i][2].x,t[i][2].y,4,0,Math.PI*2);n.fill();n.beginPath();n.moveTo(t[i][0].x,t[i][0].y);n.lineTo(t[i][1].x,t[i][1].y);n.strokeStyle="green";n.stroke();n.beginPath();n.strokeStyle="blue";n.moveTo(t[0][2].x,t[0][2].y);for(var o=1;o<i;o++)n.lineTo(t[o][2].x,t[o][2].y);if(n.stroke(),i++,i===h){i=0;window.setTimeout(()=>{window.requestAnimationFrame(e)},1e3);return}window.requestAnimationFrame(e)};window.requestAnimationFrame(e)}function test1(){var t;let e=cavlib("canvas1").style(),n=e.ctx;n.lineWidth=2;n.font="16px serial";let r={x:20,y:120},u={x:80,y:30},f={x:250,y:130};n.moveTo(r.x,r.y);n.lineTo(u.x,u.y);n.lineTo(f.x,f.y);n.stroke();n.fillText("S(起点)",5,140);n.fillText("C(控制点)",60,20);n.fillText("E(终点)",250,145);let i=[];for(t=0;t<3;t++){let n=getBezier2Point(r,u,f,28*(t+1));if(n==null)break;i.push(n)}for(t=0;t<i.length;t++)n.beginPath(),n.fillStyle="black",n.fillText("A"+(t+1),i[t][0].x-25,i[t][0].y-5),n.arc(i[t][0].x,i[t][0].y,4,0,Math.PI*2),n.fill(),n.beginPath(),n.fillText("B"+(t+1),i[t][1].x+5,i[t][1].y-5),n.arc(i[t][1].x,i[t][1].y,4,0,Math.PI*2),n.fill(),n.beginPath(),n.fillStyle="red",n.fillText("a"+(t+1),i[t][2].x-10,i[t][2].y+20),n.arc(i[t][2].x,i[t][2].y,4,0,Math.PI*2),n.fill(),n.beginPath(),n.moveTo(i[t][0].x,i[t][0].y),n.lineTo(i[t][1].x,i[t][1].y),n.strokeStyle="green",n.stroke();for(n.beginPath(),n.strokeStyle="red",n.moveTo(i[0][2].x,i[0][2].y),t=1;t<i.length;t++)n.lineTo(i[t][2].x,i[t][2].y);n.stroke()}function getPoints2Bezier(n,t,i,r=2){let u=r,e=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2)),f={a:[],b:[],a1:[]};if(n.x===t.x){for(;;){let o={x:0,y:0};if(o.x=n.x,o.y=n.y+(n.y>t.y?-u:+u),o.y>Math.max(n.y,t.y)||o.y<Math.min(n.y,t.y))break;let s={x:0,y:0};s.x=t.x+u*(i.x-t.x)/e;s.y=t.y-(t.y-i.y)*(s.x-t.x)/(i.x-t.x);let h={x:0,y:0};h.x=o.x+u*(s.x-o.x)/e;h.y=o.y-(o.y-s.y)*(h.x-o.x)/(s.x-o.x);u+=r;f.a.push(o);f.b.push(s);f.a1.push(h)}return f}for(;;){let o={x:0,y:0};if(o.x=n.x+u*(t.x-n.x)/e,o.y=n.y-(n.y-t.y)*(o.x-n.x)/(t.x-n.x),o.x>Math.max(n.x,t.x)||o.x<Math.min(n.x,t.x))break;let s={x:0,y:0};s.x=t.x+u*(i.x-t.x)/e;s.y=t.y-(t.y-i.y)*(s.x-t.x)/(i.x-t.x);let h={x:0,y:0};h.x=o.x+u*(s.x-o.x)/e;h.y=o.y-(o.y-s.y)*(h.x-o.x)/(s.x-o.x);u+=r;f.a.push(o);f.b.push(s);f.a1.push(h)}return f}function getBezierNPoint(n,t=2){let r=[],u=n.length-3,i=n;for(let n=0;n<u;n++){let u=i.length-1,f=Math.floor(u/2),n=[];for(let u=0;u<f;u++){let f=getPointsABBezier(i[u*2],i[u*2+1],i[u*2+2],t);if(f.length==0)return null;n=n.concat(f);r=r.concat(f)}if(u%2==1){let u=getPointsABBezier(i[i.length-3],i[i.length-2],i[i.length-1],t);n=n.concat(u[1]);r=r.concat(u[1])}i=n}let f=getBezier2Point(i[0],i[1],i[2],t);return r=r.concat(f)}function getBezier2Point(n,t,i,r=2){let u=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));if(n.x===t.x){let f={x:0,y:0};if(f.x=n.x,f.y=n.y+(n.y>t.y?-r:+r),f.y>Math.max(n.y,t.y)||f.y<Math.min(n.y,t.y))return null;let e={x:0,y:0};e.x=t.x+r*(i.x-t.x)/u;e.y=t.y-(t.y-i.y)*(e.x-t.x)/(i.x-t.x);let o={x:0,y:0};return o.x=f.x+r*(e.x-f.x)/u,o.y=f.y-(f.y-e.y)*(o.x-f.x)/(e.x-f.x),[f,e,o]}else{let f={x:0,y:0};if(f.x=n.x+r*(t.x-n.x)/u,f.y=n.y-(n.y-t.y)*(f.x-n.x)/(t.x-n.x),f.x>Math.max(n.x,t.x)||f.x<Math.min(n.x,t.x))return null;let e={x:0,y:0};e.x=t.x+r*(i.x-t.x)/u;e.y=t.y-(t.y-i.y)*(e.x-t.x)/(i.x-t.x);let o={x:0,y:0};return o.x=f.x+r*(e.x-f.x)/u,o.y=f.y-(f.y-e.y)*(o.x-f.x)/(e.x-f.x),[f,e,o]}}function getPointsABBezier(n,t,i,r=2){let u=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));if(n.x===t.x){let f={x:0,y:0};if(f.x=n.x,f.y=n.y+(n.y>t.y?-r:+r),f.y>Math.max(n.y,t.y)||f.y<Math.min(n.y,t.y))return[];let e={x:0,y:0};return e.x=t.x+r*(i.x-t.x)/u,e.y=t.y-(t.y-i.y)*(e.x-t.x)/(i.x-t.x),[f,e]}else{let f={x:0,y:0};if(f.x=n.x+r*(t.x-n.x)/u,f.y=n.y-(n.y-t.y)*(f.x-n.x)/(t.x-n.x),f.x>Math.max(n.x,t.x)||f.x<Math.min(n.x,t.x))return[];let e={x:0,y:0};return e.x=t.x+r*(i.x-t.x)/u,e.y=t.y-(t.y-i.y)*(e.x-t.x)/(i.x-t.x),[f,e]}}test1();test2();test3();test4();test5()</script></div></div><div class=nav-page-inside><h6 class=txt-center>本文内容</h6><div class="flex flex-col" id=navOfInPage></div></div></div><div class="bd-t-1 bd-t-gray-3 txt-center mg-b-10">End Line</div></div><script src=/asset/js/mainmenu.js></script><script src=/asset/js/navinpage.js></script>